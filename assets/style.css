/* ── WhaleTracker AI — Dark Fintech Theme ───────────────────────────────── */

/* ── Ticker autocomplete dropdown (dark theme) ── */
#h-ticker .Select-control,
#h-ticker .VirtualizedSelectFocusedOption,
#h-ticker.is-focused:not(.is-open) > .Select-control {
    background: #1C2333 !important;
    border: 1px solid #2E3952 !important;
    border-radius: 6px !important;
    color: #E8ECF0 !important;
    min-height: 30px !important;
    height: 30px !important;
    box-shadow: none !important;
}
#h-ticker .Select-value-label,
#h-ticker .Select-placeholder {
    color: #9BA3B8 !important;
    font-size: 0.78rem !important;
    line-height: 28px !important;
}
#h-ticker .Select-value-label { color: #E8ECF0 !important; }
#h-ticker .Select-arrow-zone .Select-arrow { border-top-color: #9BA3B8 !important; }
#h-ticker .Select-input > input { color: #E8ECF0 !important; font-size: 0.78rem !important; }
#h-ticker .Select-menu-outer {
    background: #1C2333 !important;
    border: 1px solid #2E3952 !important;
    border-radius: 6px !important;
    z-index: 9999 !important;
}
#h-ticker .Select-option {
    background: #1C2333 !important;
    color: #E8ECF0 !important;
    font-size: 0.78rem !important;
}
#h-ticker .Select-option.is-focused,
#h-ticker .Select-option:hover {
    background: #2E3952 !important;
}
#h-ticker .Select-clear-zone { color: #9BA3B8 !important; }

*, *::before, *::after { box-sizing: border-box; }

body {
    margin: 0;
    background: #0D0F14;
    font-family: 'Inter', -apple-system, sans-serif;
    color: #E8ECF0;
}

/* ── App shell ── */
.app-shell {
    background: #0D0F14;
    min-height: 100vh;
    padding: 1.5rem 2rem 3rem;
}

/* ── Header ── */
.header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 1.2rem;
    border-bottom: 1px solid rgba(255,255,255,0.07);
    margin-bottom: 1.4rem;
}
.header-left  { display: flex; align-items: center; gap: 14px; }
.header-right { display: flex; align-items: center; gap: 10px; }

.logo-emoji  { font-size: 2rem; line-height: 1; filter: drop-shadow(0 0 12px #4B7BE566); }
.logo-title  { font-size: 1.4rem; font-weight: 800; color: #E8ECF0; letter-spacing: -0.5px; line-height: 1.15; }
.logo-ai     { color: #4B7BE5; }
.logo-sub    { font-size: 0.7rem; color: #8892A4; font-weight: 400; letter-spacing: 0.4px; margin-top: 2px; }

.mode-badge  { border-radius: 6px; padding: 3px 10px; font-size: 0.67rem; font-weight: 700; letter-spacing: 0.8px; }
.timestamp   { color: #8892A4; font-size: 0.75rem; }

/* ── KPI Strip ── */
.kpi-strip {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.8rem;
    margin-bottom: 1.5rem;
}
.kpi-card {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 14px;
    padding: 1.1rem 1.3rem;
    position: relative;
    overflow: hidden;
}
.kpi-label { font-size: 0.63rem; color: #8892A4; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; margin-bottom: 0.3rem; }
.kpi-value { font-size: 1.65rem; font-weight: 800; color: #E8ECF0; letter-spacing: -0.5px; line-height: 1.05; }
.kpi-sub   { font-size: 0.68rem; color: #8892A4; margin-top: 0.2rem; }

/* ── Tabs ── */
.main-tabs {
    background: #161922 !important;
    border-radius: 12px !important;
    padding: 4px !important;
    border: 1px solid rgba(255,255,255,0.07) !important;
    display: inline-flex !important;
    width: auto !important;
}
.tab {
    background: transparent !important;
    border-radius: 8px !important;
    color: #8892A4 !important;
    font-family: 'Inter', sans-serif !important;
    font-weight: 500 !important;
    font-size: 0.87rem !important;
    padding: 7px 20px !important;
    border: none !important;
    transition: all 0.15s ease !important;
}
.tab:hover  { color: #E8ECF0 !important; }
.tab-active { background: #1E2130 !important; color: #E8ECF0 !important; font-weight: 600 !important; border: none !important; }

/* Remove default Dash tab styling */
.tab--selected, .tab { border-bottom: none !important; }
.tabs-content         { border: none !important; }

/* ── Grid Helpers ── */
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.6rem; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.8rem; }

/* ── Holding Cards (Tab 1) ── */
.holding-card {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 12px;
    padding: 0.9rem;
    margin-bottom: 0.6rem;
}
.holding-header  { display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.45rem; }
.holding-ticker  { font-size: 1.1rem; font-weight: 800; color: #E8ECF0; letter-spacing: -0.3px; }
.holding-company { font-size: 0.71rem; color: #8892A4; margin-bottom: 0.65rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.holding-stats   { display: flex; justify-content: space-between; align-items: flex-end; }

/* ── Whale Section Headers (Tab 1) ── */
.whale-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 1.4rem 0 0.8rem;
    padding-bottom: 0.6rem;
    border-bottom: 1px solid rgba(255,255,255,0.07);
}
.whale-name { font-size: 1rem; font-weight: 700; color: #E8ECF0; }
.whale-meta { color: #8892A4; font-size: 0.74rem; }

/* ── Stat primitives ── */
.stat-label { font-size: 0.58rem; color: #8892A4; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 1px; }
.stat-value { font-size: 0.9rem; font-weight: 600; color: #E8ECF0; }

/* ── Recommendation Cards (Tab 2) ── */
.rec-filter-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}
.rec-filter {
    display: flex !important;
    gap: 6px !important;
    flex-wrap: wrap;
}
.rec-filter label {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 20px;
    padding: 5px 14px;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    color: #8892A4;
    font-family: 'Inter', sans-serif;
    transition: all 0.15s ease;
}
.rec-filter label:has(input:checked) {
    background: #1E2130;
    border-color: #4B7BE5;
    color: #E8ECF0;
}
.rec-filter input[type="radio"] { display: none; }

.rec-count   { color: #8892A4; font-size: 0.73rem; text-align: right; }
.rec-card    { background: #161922; border: 1px solid rgba(255,255,255,0.07); border-radius: 14px; padding: 1.1rem; margin-bottom: 0.8rem; }
.rec-header  { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 0.75rem; }
.rec-ticker  { font-size: 1.5rem; font-weight: 800; color: #E8ECF0; letter-spacing: -0.8px; line-height: 1; }
.rec-company { font-size: 0.7rem; color: #8892A4; margin-top: 3px; }
.rec-footer  { font-size: 0.67rem; color: #8892A4; border-top: 1px solid rgba(255,255,255,0.07); padding-top: 0.5rem; line-height: 1.4; }

.conviction-row   { display: flex; justify-content: space-between; margin-bottom: 4px; }
.conviction-track { background: #1E2130; border-radius: 3px; height: 4px; overflow: hidden; }

/* ── Portfolio Tab ── */
.charts-row {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 1rem;
    margin-bottom: 1rem;
}
.section-header {
    display: flex;
    align-items: baseline;
    gap: 8px;
    margin: 0.6rem 0 0.8rem;
    padding-top: 0.8rem;
    border-top: 1px solid rgba(255,255,255,0.07);
}
.section-title { font-size: 0.95rem; font-weight: 700; color: #E8ECF0; }
.success-banner {
    background: #161922;
    border: 1px solid rgba(0,208,156,0.27);
    border-radius: 12px;
    padding: 1rem;
    color: #00D09C;
    font-size: 0.85rem;
}

/* ── Rebalancing Cards ── */
.reb-card     { background: #161922; border: 1px solid rgba(255,255,255,0.07); border-radius: 12px; padding: 0.9rem 1rem; margin-bottom: 0.6rem; }
.reb-header   { display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.55rem; }
.reb-sector   { font-weight: 700; font-size: 0.9rem; color: #E8ECF0; }
.reb-stats    { display: flex; gap: 0.8rem; align-items: flex-end; margin-bottom: 0.5rem; }
.reb-rationale{ font-size: 0.68rem; color: #8892A4; line-height: 1.5; }

/* ── Raw Holdings Table ── */
.expander-summary {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 10px;
    padding: 0.6rem 1rem;
    color: #E8ECF0;
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    list-style: none;
    margin-top: 1rem;
    font-family: 'Inter', sans-serif;
}
details[open] .expander-summary { border-radius: 10px 10px 0 0; }
.raw-table-wrapper {
    background: #1E2130;
    border: 1px solid rgba(255,255,255,0.07);
    border-top: none;
    border-radius: 0 0 10px 10px;
    overflow-x: auto;
}
.raw-table   { width: 100%; border-collapse: collapse; font-family: 'Inter', sans-serif; }
.tbl-th      { padding: 7px 10px; color: #8892A4; font-weight: 600; font-size: 0.63rem; text-transform: uppercase; letter-spacing: 0.6px; border-bottom: 1px solid rgba(255,255,255,0.07); }

/* ── Empty state ── */
.empty-state {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 12px;
    padding: 2.5rem;
    text-align: center;
    color: #8892A4;
    font-size: 0.88rem;
    margin-top: 1rem;
}

/* ── Scrollbar ── */
::-webkit-scrollbar         { width: 5px; height: 5px; }
::-webkit-scrollbar-track   { background: #0D0F14; }
::-webkit-scrollbar-thumb   { background: rgba(255,255,255,0.07); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(136,146,164,0.4); }

/* ── Plotly containers ── */
.js-plotly-plot { background: transparent !important; }

/* ── Guide Button ── */
.guide-btn {
    background: #1E2130;
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: 8px;
    color: #E8ECF0;
    font-family: 'Inter', sans-serif;
    font-size: 0.82rem;
    font-weight: 600;
    padding: 6px 14px;
    cursor: pointer;
    transition: all 0.15s ease;
    white-space: nowrap;
}
.guide-btn:hover {
    background: #262d40;
    border-color: #4B7BE5;
    color: #fff;
}

/* ── Guide Modal ── */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.72);
    backdrop-filter: blur(4px);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1.5rem;
}
.modal-box {
    background: #161922;
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: 18px;
    width: 100%;
    max-width: 680px;
    max-height: 86vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 24px 64px rgba(0,0,0,0.6);
    overflow: hidden;
}
.modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.1rem 1.4rem;
    border-bottom: 1px solid rgba(255,255,255,0.07);
    flex-shrink: 0;
}
.modal-title {
    font-size: 1rem;
    font-weight: 700;
    color: #E8ECF0;
    display: flex;
    align-items: center;
}
.modal-close {
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.09);
    border-radius: 8px;
    color: #8892A4;
    font-size: 0.95rem;
    width: 30px;
    height: 30px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    font-family: 'Inter', sans-serif;
    transition: all 0.15s ease;
}
.modal-close:hover { background: rgba(255,71,87,0.15); color: #FF4757; border-color: #FF475755; }

/* ── Language Toggle (inside modal) ── */
.lang-tabs {
    background: #1E2130 !important;
    border-radius: 0 !important;
    padding: 8px 1.4rem !important;
    border: none !important;
    border-bottom: 1px solid rgba(255,255,255,0.07) !important;
    display: flex !important;
    gap: 6px !important;
    width: auto !important;
    flex-shrink: 0;
}
.lang-tab {
    background: transparent !important;
    border: 1px solid rgba(255,255,255,0.08) !important;
    border-radius: 6px !important;
    color: #8892A4 !important;
    font-family: 'Inter', sans-serif !important;
    font-size: 0.8rem !important;
    font-weight: 500 !important;
    padding: 4px 14px !important;
    cursor: pointer !important;
    transition: all 0.15s ease !important;
}
.lang-tab:hover { color: #E8ECF0 !important; }
.lang-tab-active {
    background: #4B7BE522 !important;
    border-color: #4B7BE5 !important;
    color: #E8ECF0 !important;
    font-weight: 600 !important;
}

/* ── Guide Scroll Area ── */
.guide-scroll {
    overflow-y: auto;
    flex: 1;
    padding: 1.2rem 1.4rem 1.4rem;
}
.guide-body { display: flex; flex-direction: column; gap: 1.2rem; }

/* ── Guide Sections ── */
.gsec {
    background: #1E2130;
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 12px;
    padding: 1rem 1.1rem;
}
.gsec-title {
    font-size: 0.72rem;
    font-weight: 700;
    color: #4B7BE5;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 0.7rem;
}
.gsec p { margin: 0; }

/* ── Guide Rows (signals / recommendations) ── */
.grow {
    padding: 0.55rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.grow:last-child { border-bottom: none; }
.grow-desc {
    font-size: 0.78rem;
    color: #8892A4;
    line-height: 1.55;
    margin: 0;
}

/* ── Whale Rows ── */
.gwhale-row {
    display: flex;
    align-items: center;
    padding: 0.45rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.gwhale-row:last-child { border-bottom: none; }
.gwhale-name { font-size: 0.84rem; font-weight: 600; color: #E8ECF0; }
.gwhale-mgr  { font-size: 0.71rem; color: #8892A4; margin-top: 1px; }

/* ── Tab Guide Rows ── */
.gtab-row {
    padding: 0.55rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.gtab-row:last-child { border-bottom: none; }
.gtab-title {
    font-size: 0.86rem;
    font-weight: 600;
    color: #E8ECF0;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
}

/* ── Guide Notes List ── */
.guide-notes {
    margin: 0.3rem 0 0;
    padding-left: 1.2rem;
    color: #8892A4;
    font-size: 0.78rem;
    line-height: 1.7;
}
.guide-notes li { margin-bottom: 2px; }

/* ── Plotly — disable touch zoom globally ── */
.js-plotly-plot .nsewdrag,
.js-plotly-plot .nwdrag,
.js-plotly-plot .nedrag,
.js-plotly-plot .swdrag,
.js-plotly-plot .sedrag { touch-action: none !important; }
.plotly-graph-div { touch-action: pan-y !important; }

/* ── Responsive — Tablet (≤ 900px) ── */
@media (max-width: 900px) {
    .app-shell  { padding: 1rem; }
    .kpi-strip  { grid-template-columns: repeat(2, 1fr); }
    .kpi-value  { font-size: 1.45rem; }
    .grid-4     { grid-template-columns: repeat(2, 1fr); }
    .grid-3     { grid-template-columns: repeat(2, 1fr); }
    .charts-row { grid-template-columns: 1fr; }

    /* Plotly charts don't overflow card width */
    .js-plotly-plot, .plotly-graph-div { max-width: 100% !important; }
}

/* ── Responsive — Phone (≤ 620px) ── */
@media (max-width: 620px) {
    .app-shell { padding: 0.75rem; }

    /* Header: logo on top row, controls on second row */
    .header       { flex-wrap: wrap; gap: 6px; padding-bottom: 0.8rem; }
    .header-left  { flex: 1 1 100%; min-width: 0; }
    .header-right {
        flex: 1 1 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 6px;
        flex-wrap: nowrap;
    }
    .logo-title  { font-size: 1.15rem; }
    .logo-emoji  { font-size: 1.55rem; }
    .logo-sub    { font-size: 0.6rem; }
    /* Hide timestamp — reclaim space for login button */
    .timestamp   { display: none; }
    /* Login / user badge always visible */
    #auth-header-section { margin-left: auto; flex-shrink: 0; }
    .guide-btn   { padding: 8px 12px; font-size: 0.76rem; min-height: 38px; min-width: 80px; }

    /* KPI strip */
    .kpi-strip { gap: 0.5rem; }
    .kpi-card  { padding: 0.8rem 0.9rem; }
    .kpi-value { font-size: 1.15rem; }
    .kpi-label { font-size: 0.55rem; }
    .kpi-sub   { font-size: 0.61rem; }

    /* Tabs: horizontal scroll, no overflow */
    .main-tabs {
        display: flex !important;
        max-width: 100% !important;
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
        scrollbar-width: none !important;
        width: 100% !important;
    }
    .main-tabs::-webkit-scrollbar { display: none !important; }
    .tab {
        flex-shrink: 0 !important;
        white-space: nowrap !important;
        padding: 9px 12px !important;
        font-size: 0.76rem !important;
        min-height: 38px !important;
    }

    /* Grids */
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: 1fr; }

    /* Holding cards */
    .holding-card   { padding: 0.75rem; }
    .holding-ticker { font-size: 0.92rem; }

    /* Whale section headers */
    .whale-header { flex-wrap: wrap; gap: 6px; }

    /* Recommendation cards */
    .rec-card       { padding: 0.85rem 0.9rem; }
    .rec-ticker     { font-size: 1.15rem; }
    .rec-filter-row { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
    .rec-count      { text-align: left; }
    .rec-filter label { min-height: 34px; display: inline-flex; align-items: center; }

    /* Rebalancing cards */
    .reb-stats  { flex-wrap: wrap; gap: 0.5rem; }
    .reb-header { flex-wrap: wrap; gap: 6px; }

    /* Section headers */
    .section-header { flex-wrap: wrap; }

    /* Charts row */
    .charts-row { grid-template-columns: 1fr; }

    /* Plotly — full width, no overflow */
    .js-plotly-plot, .plotly-graph-div { max-width: 100% !important; overflow: hidden; }

    /* Guide modal */
    .modal-overlay { padding: 0.5rem; }
    .modal-box     { max-height: 95vh; border-radius: 14px; }
    .modal-header  { padding: 0.85rem 1rem; }
    .modal-close   { width: 38px; height: 38px; }
    .guide-scroll  { padding: 0.9rem 1rem 1.2rem; }
    .lang-tabs     { padding: 6px 1rem !important; }

    /* Sector context: stack cards vertically */
    .sector-context-cards { flex-direction: column !important; }

    /* Activist battlefield: stack left + timeline vertically */
    .activist-row { flex-direction: column !important; gap: 10px !important; }
    .activist-meta { min-width: unset !important; margin-right: 0 !important; }
}

/* ── Responsive — Small Phone (≤ 420px) ── */
@media (max-width: 420px) {
    .app-shell  { padding: 0.5rem; }
    .kpi-strip  { gap: 0.4rem; }
    .kpi-card   { padding: 0.7rem 0.75rem; }
    .kpi-value  { font-size: 1.05rem; }
    .kpi-label  { font-size: 0.52rem; }
    .logo-title { font-size: 1rem; }
    .logo-emoji { font-size: 1.4rem; }
    .grid-4     { grid-template-columns: 1fr; }
    .tab        { padding: 8px 10px !important; font-size: 0.72rem !important; }
    .rec-header { flex-wrap: wrap; gap: 6px; }
    .rec-ticker { font-size: 1rem; }
    /* Auth button compact */
    .guide-btn  { padding: 7px 10px; font-size: 0.72rem; min-width: 70px; }
}
